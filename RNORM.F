      FUNCTION RNORM(RMEAN, STDEV, RMIN, RMAX)

C ASSIGNED TRUNCATED RANDOM NORMAL DEVIATE TO FUNCTION NAME RNORM,
C ASSIGNS THE VALUE RMIN OR RMAX, NOT REDRAWN WHEN OUTSIDE THE RANGE (RMIN, RMAX).
C WHEN STDEV. = 0.0, RNORM IS SET = RMEAN, LEAVING MIN AND MAX INEFFECTIVE.

      IF (STDEV) 99, 99, 1

1     RA = RANUM(0)
      RB = RANUM(0)
      V = (-2.0 * ALOG(RA)) ** 0.5 * COS(6.283 * RB)
      RNORM = V * STDEV + RMEAN

      IF (RNORM - RMIN) 6, 7, 8

6     RNORM = RMIN
7     RETURN
8     IF (RNORM - RMAX) 7, 7, 9
9     RNORM = RMAX
      RETURN
99    RNORM = RMEAN
      
      RETURN
      END
