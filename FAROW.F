      SUBROUTINE FAROW(IN,VEN)
      
      COMMON /INIT/ NR, NW, ND, NT7, NT8, NDAT, NS1, NS2
      COMMON /GEN/ ITOT, ISIZE, NOWT, NOWY, NDAYS, NRUNS, IATRIB(18), ATRIB(4)
      COMMON /BRED/ LBREED, NBREED, IFAR(30), IDB(30), KAGEW, LGTHW, NAGEM
      COMMON /SURVIV/ PW1, PW23, PSRT, PSFIN, PSOWS, PBORS, PBORS1, MDEAD(8)
      COMMON /GAIN/ GW1, GW23, GSRT, GFIN1, GFIN2, GSOWM, GSOWL, SDP, SSOWM, SSOWL
      COMMON /BIRTH/ BRNM, BRNS, BMIN, BMAX, BWTM, BWTS, BWMIN, BWMAX, NOBRN
      COMMON /CLEAN/ NDPREV, NH4CLN, LOSSL, SWTLP, SSLP, KL4
      COMMON /HOUSE/ NH(6), N1, N2, N3, N4, N5, N6, NXTFAR, MX1, MX2, MX3, MX4, X1, X2, X4
      COMMON /RPT4/ IDCS, IDCE, IDCN, IDCF, IDCM, IDCB, IDCFS, IDCFP, IOFLW
      COMMON /RPT3/ MJEV, ISALS, IFARS, IBRDS
      COMMON /STAT/ SUM(5, 20), SUM2(5, 10), SUM3(5, 10), SUM4(5, 10)
      COMMON /RPT1/ ISMYP, ISMB, ISMBG, ISMF, ISMW, ISMS, ISMM

      DIMENSION IN(3,1),VEN(2,1)
C BRANCH OF SUBROUTINE UPDATE FROM 6000 S.
C SOW IS TO FARROW AND CREATE PIGS= IATRIB(8)

C WEANING TO MAKE ROOM FOR THIS SOW TO FARROW.
      IF(KL4-MX1) 409, 18, 18
18    IF(NH4CLN) 99, 99, 19
19    JX1 = X1
      IF(JX1) 199, 199, 21
21    KDO = NH(1)

C       LOOK FOR LITTER OF LEGAL WEANING AGE= KAGEW-X1.
C       TEMP. STORE SOW IN IDB()
      DO 22 I = 5,18
22    IDB(I) = IATRIB(I - 4)
      XAT1 = ATRIB(1)
      XAT2 = ATRIB(2)
      DO 27 I = 1,KDO
      CALL REMOV(IN, VEN, 1)
      IF(IATRIB(4) - KAGEW - JX1) 26, 29, 29
26    CALL FILEM(IN, VEN, 4)
27    CONTINUE
      GO TO 39

C FOUND SOW WITH LITTER, WEAN HER AND PIGS.
29    IATRIB(3) = 2
      IATRIB(4) = IATRIB(10) / 3 * 2 + 1
      IATRIB(8) = 0
      IATRIB(11) = 0
      ATRIB(2) = RNORM(GSOWM, SSOWM, -5.0, 10.0)
      CALL FILEM(IN, VEN, 6)
30    IF(VEN(1,1)-100.0) 31, 31, 33

C OVER 100 POUNDS IS NEXT SOW, I.E. HAVE ALL OF LITTER, STOP
31    CALL REMOV(IN, VEN, 1)
      CALL FILEM(IN, VEN, 5)
      GO TO 30

C STOP WEANING, ALLOW ORIGINAL SOW TO FARROW.
33    DO 35 I = 5,18
35    IATRIB(I - 4) = IDB(I)
      ATRIB(1) = XAT1
      ATRIB(2) = XAT1
      GO TO 410

39    DO 41 I = 5,18
41    IATRIB(I - 4) = IDB(I)
      ATRIB(1) = XAT1
      ATRIB(2) = XAT2
      GO TO 199
C END SPECIAL HOUSE OVERFLOW WEANING PROCEDURE.


C IF BUILDING HAS BEEN CLEANED NH4CLN=1
409   IF(NH4CLN) 99, 99, 410

C SOW IS FARROWING.
410   NAMDAM = IATRIB(5)
      NP = IATRIB(8)
      IATRIB(1) = IATRIB(1) + 1
      IATRIB(3) = 4
      IATRIB(4) = 1
      IATRIB(9) = IATRIB(9) + 1
      IF(RANUM(0) .GT. PSOWS) GO TO 613

C COUNT OF LITTERS +1
      KL4 = KL4 + 1

C WT. LOSS AT FARROWING.
      WTL = NP * RNORM(SWTLP, SSLP, -10.0, 10.0)
      ATRIB(1) = ATRIB(1) - WTL
      ATRIB(2) = RNORM(GSOWL, SSOWL, -5.0, 10.0)

C COLLECT SEASONAL REPORT STATS ON SOW FARROWING.
C SEASONAL IN SUM2(), TERM REPORTS IN SUM3().
      RMX1 = MX1
      RKL4 = KL4
      FILL = RKL4 / RMX1 * 100.0
      RNP = NP
      RNOWT = NOWT
      IF(IFARS) 398, 398, 300
300   CALL COLLECT(SUM2, 1, RNP)
      CALL COLLECT(SUM2, 2, RNOWT)
      CALL COLLECT(SUM2, 3, FILL)
398   IF(ISMF) 397, 397, 310
310   CALL COLLECT(SUM3, 1, RNP)
      CALL COLLECT(SUM3, 3, FILL)

C FILE THE SOW
397   CALL FILEM(IN, VEN, 4)

C CREATE NP PIGS FOR ABOVE SOW, ALSO FILE IN HOUSE 4
C       INCREASE TOTAL BIRTHS -NOBRN- COUNTER.
      DO 63 KP = 1,NP
      NOBRN = NOBRN + 1

C FILL ZEROED ATTRIBUTES.
      IATRIB(1) = 1
      IF(ISEX .NE. 1) GO TO 8
      IATRIB(2) = 3
      ISEX = 0
      GO TO 9
8     IATRIB(2) = 2
      IATRIB(3) = 1
      ISEX = 1


C MTP: POINTING OUT WHAT SEEMS TO BE A CORRECT USE OF IFAR(30)

C LET IFAR(30)= CURRENT FARROWING 1-6 OF CURRENT YEAR NOWY.
C       SET IN SUBROUTINE EVENTS.
      MFAR = IFAR(30)
9     IATRIB(5) = MFAR * 10000 + NOBRN
      IATRIB(6) = 4
      IATRIB(8) = NAMDAM
      IATRIB(9) = NOWT

C MTP: NOT SURE IF IT MEANS NEGATIVE .09 HERE OR THE DASH IS JUST A SEPARATOR?

C BIRTH WT) = MEAN ADJUSTED BY -.09 FOR DEVIATION FROM AVERAGE NO.
C       OF PIGS IN THE LITTER, OMTVEDT, ET. AL.
      RNP = NP
      BWME = BWTM + (RNP - BRNM) * 0.09
      BT = RNORM(BWME, BWTS, BWMIN, BWMAX)
      IATRIB(11) = BT * 100.0
      ATRIB(1) = BT
      ATRIB(2) = 0.0

C     FILE THIS PIG.
C
C COLLECT SEASONAL REPORT STATS ON PIG IN SUM2(), TERM IN SUM3().
      IF(IFARS) 399, 399, 301
301   CALL COLLECT(SUM2, 4, BT)
399   IF(ISMF) 400, 400, 303
303   CALL COLLECT(SUM3, 4, BT)

C FILE THIS PIG.
400   CALL FILEM(IN, VEN, 4)
63    CONTINUE

      RETURN
613   IATRIB(1) = 0
      MDEAD(6) = MDEAD(6) + 1
      RETURN

99    LOSSL = LOSSL + 1
      RNP = IATRIB(8)
      CALL COLLECT(SUM2, 5, RNP)
      WRITE(ND, 1303) NOWT, NH4CLN, (IATRIB(M), M = 1,15)
1303  FORMAT('LOSS NEW LITTER, NOWT='I5' NH4CLN='I2',IATRIB()='/10X,15I5)
      RETURN

199   LOSSL = LOSSL + 1
      RNP = IATRIB(8)
      CALL COLLECT(SUM2, 6, RNP)
      CALL COLLECT(SUM3, 6, RNP)

C TAPE ND OVERFLOW MESSAGE OPTION.
      IF(IOFLW) 1309, 1309, 1307
1307  WRITE(ND, 1304) MX1, NOWT
1304  FORMAT(/3X'FARROWING OVERFLOW, SOW RETURNED OPEN AND LITTER LOST.  ALL'I3' CRATES FULL AT DAY='I5)

1309  RETURN
      END